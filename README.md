# FLAC/APE + CUE to MP3 Converter

This is a powerful command-line script for converting single-file FLAC or APE albums, paired with a `.cue` sheet, into individual, tagged MP3 files. It also handles standalone audio files and uses parallel processing to significantly speed up the conversion of large collections.

This script was originally generated by the LLM **Claude Opus 4.1** and was subsequently debugged and corrected by **Google Gemini 2.5 PRO**.

-----

## English

### Description

This script automates the process of splitting and converting high-quality lossless audio albums into a convenient MP3 format. It recursively scans the current directory for `.cue` files, identifies the associated audio file (FLAC or APE), splits it into individual tracks, and converts each track to a high-quality VBR MP3. The resulting files are tagged with metadata extracted from the CUE sheet and the command-line arguments.

### Features

  - **CUE Sheet Splitting**: Automatically reads `.cue` files to split single-file albums into separate tracks.
  - **Format Support**: Converts both FLAC and APE audio files.
  - **Parallel Processing**: Encodes multiple tracks simultaneously to drastically reduce conversion time.
  - **Metadata Tagging**: Tags the final MP3 files with Artist, Album, Title, Genre, Disc Number, and Track Number.
  - **Robust Encoding Handling**: Correctly interprets CUE files with legacy character encodings (e.g., WINDOWS-1252) to prevent metadata corruption.
  - **UTF-8 Filename Support**: Preserves accented and special characters in the final MP3 filenames.
  - **Directory Structure Preservation**: Recreates the source directory structure within the specified output folder.
  - **Standalone File Conversion**: Can also convert any `.flac` or `.ape` files that are not associated with a CUE sheet.

### Dependencies

You must have the following command-line tools installed on your system:

  - `ffmpeg`: For audio conversion and tagging.
  - `cuetools`: Provides `cueprint` for reading CUE sheet metadata.
  - `shntool`: Provides `shnsplit` for splitting audio files based on CUE data.

**Installation Instructions:**

  - **Debian / Ubuntu:**
    ```sh
    sudo apt-get update
    sudo apt-get install ffmpeg cuetools shntool
    ```
  - **macOS (using Homebrew):**
    ```sh
    brew install ffmpeg cuetools shntool
    ```
  - **Fedora:**
    ```sh
    sudo dnf install ffmpeg cuetools shntool
    ```

### Usage

Run the script from the command line, providing at least the artist's name. It's best to run the script from within the root directory containing the albums you wish to convert.

```
Usage: ./convert-flac-or-cue-to-mp3.sh --artist "Artist Name" [OPTIONS]

Required:
  --artist "name"    Artist name for metadata

Optional:
  --album "name"     Album name for metadata
  --genre "name"     Genre for metadata
  --disc "N"         Disc number for metadata
  --output "dir"     Output directory (default: MP3_Export)
  --parallel N       Number of parallel conversion jobs (default: 4)
  --help             Show this help message
```

### Example

To convert all albums in the current directory for the artist "Debussy", specifying the album, genre, and using 8 parallel processes:

```sh
./convert-flac-or-cue-to-mp3.sh --artist "Debussy" --album "Complete Works" --genre "Classical" --parallel 8
```

-----

## Italiano

### Descrizione

Questo script automatizza il processo di divisione e conversione di album audio lossless di alta qualità in un comodo formato MP3. Esegue una scansione ricorsiva della directory corrente alla ricerca di file `.cue`, identifica il file audio associato (FLAC o APE), lo suddivide in tracce individuali e converte ciascuna traccia in un file MP3 VBR di alta qualità. I file risultanti vengono taggati con i metadati estratti dal CUE sheet e dagli argomenti forniti a riga di comando.

### Funzionalità

  - **Divisione tramite CUE Sheet**: Legge automaticamente i file `.cue` per suddividere gli album composti da un unico file in tracce separate.
  - **Supporto Formati**: Converte file audio sia FLAC che APE.
  - **Elaborazione Parallela**: Codifica più tracce contemporaneamente per ridurre drasticamente i tempi di conversione.
  - **Tagging dei Metadati**: Applica ai file MP3 finali i tag di Artista, Album, Titolo, Genere, Numero Disco e Numero Traccia.
  - **Gestione Robusta della Codifica**: Interpreta correttamente i CUE sheet con codifiche di caratteri legacy (es. WINDOWS-1252) per prevenire la corruzione dei metadati.
  - **Supporto Nomi File UTF-8**: Mantiene i caratteri accentati e speciali nei nomi dei file MP3 finali.
  - **Mantenimento Struttura Directory**: Ricrea la struttura delle directory di origine all'interno della cartella di output specificata.
  - **Conversione File Singoli**: Può convertire anche file `.flac` o `.ape` non associati a un CUE sheet.

### Dipendenze

È necessario che i seguenti strumenti a riga di comando siano installati sul sistema:

  - `ffmpeg`: Per la conversione audio e il tagging.
  - `cuetools`: Fornisce `cueprint` per leggere i metadati dai CUE sheet.
  - `shntool`: Fornisce `shnsplit` per dividere i file audio in base ai dati del CUE.

**Istruzioni per l'Installazione:**

  - **Debian / Ubuntu:**
    ```sh
    sudo apt-get update
    sudo apt-get install ffmpeg cuetools shntool
    ```
  - **macOS (tramite Homebrew):**
    ```sh
    brew install ffmpeg cuetools shntool
    ```
  - **Fedora:**
    ```sh
    sudo dnf install ffmpeg cuetools shntool
    ```

### Utilizzo

Eseguire lo script dalla riga di comando, fornendo almeno il nome dell'artista. Si consiglia di eseguire lo script dalla directory principale che contiene gli album da convertire.

```
Usage: ./convert-flac-or-cue-to-mp3.sh --artist "Artist Name" [OPTIONS]

Richiesto:
  --artist "name"    Nome dell'artista per i metadati

Opzionale:
  --album "name"     Nome dell'album per i metadati
  --genre "name"     Genere per i metadati
  --disc "N"         Numero del disco per i metadati
  --output "dir"     Directory di output (default: MP3_Export)
  --parallel N       Numero di processi di conversione paralleli (default: 4)
  --help             Mostra questo messaggio di aiuto
```

### Esempio

Per convertire tutti gli album nella directory corrente dell'artista "Debussy", specificando l'album, il genere e utilizzando 8 processi paralleli:

```sh
./convert-flac-or-cue-to-mp3.sh --artist "Debussy" --album "Complete Works" --genre "Classical" --parallel 8
```
